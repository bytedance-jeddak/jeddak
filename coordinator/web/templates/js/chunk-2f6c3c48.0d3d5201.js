(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2f6c3c48"],{"1d21":function(t,a,e){"use strict";e.r(a);var o=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"task"},[e("el-row",{attrs:{id:"top-buttons"}},[e("el-button-group",[e("el-button",{attrs:{type:"primary"},on:{click:t.createTask}},[t._v(" 发起任务 "),e("i",{staticClass:"el-icon-s-promotion"})])],1)],1),e("el-card",{staticClass:"box-card"},[e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.task_data}},[e("el-table-column",{attrs:{prop:"task_id",label:"任务ID"}}),e("el-table-column",{attrs:{prop:"party_name",label:"发起方"}}),e("el-table-column",{attrs:{prop:"party_names",label:"参与方"}}),e("el-table-column",{attrs:{label:"状态"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",{class:a.row.status},[t._v(t._s(t._f("task_status")(a.row.status)))])]}}])}),e("el-table-column",{attrs:{prop:"create_time",label:"任务创建时间"}}),e("el-table-column",{attrs:{prop:"update_time",label:"状态更新时间"}}),e("el-table-column",{attrs:{label:"备注"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-input",{attrs:{type:"textarea",autosize:"",placeholder:"暂无"},on:{change:function(e){return t.changeAlias(a.row)}},model:{value:a.row.alias,callback:function(e){t.$set(a.row,"alias",e)},expression:"scope.row.alias"}})]}}])}),e("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-button",{staticClass:"oper-btn",attrs:{type:"primary",size:"small"},on:{click:function(e){return t.toDetail(a.row.task_id)}}},[t._v(" 任务详情 ")]),e("el-button",{staticClass:"oper-btn",attrs:{type:"info",size:"small"},on:{click:function(e){return t.downloadLog(a.row.task_id)}}},[t._v(" 下载日志 ")])]}}])})],1),e("el-pagination",{attrs:{id:"pagination",background:"","page-size":t.page_size,"page-count":t.page_count,total:t.total_count,layout:"prev, pager, next, jumper"},on:{"current-change":t.handleCurrentChange}})],1)],1)},n=[],s=(e("d3b7"),e("3ca3"),e("ddb0"),e("2b3d"),e("25f0"),{data:function(){return{task_data:[],loading:!1,page_size:10,page_count:1,total_count:1}},mounted:function(){null!==window.localStorage.getItem("jeddak_token")&&this.getTaskData(1)},methods:{getTaskData:function(t){var a=this;this.loading=!0;var e=new URLSearchParams({req_type:"info",filter:JSON.stringify({deleted:!1}),page_size:this.page_size,curr_page:t,order_by:"-create_time"});this.$axios.get("/board/tasks?"+e.toString(),{headers:{auth:window.localStorage.getItem("jeddak_token")}}).then((function(t){a.task_data=t.data.data.tasks;for(var e=0;e<a.task_data.length;e++)a.task_data[e].create_time=new Date(a.task_data[e].create_time+"Z").toLocaleString(),a.task_data[e].update_time=new Date(a.task_data[e].update_time+"Z").toLocaleString();a.total_count=t.data.data.total_count,a.page_count=Math.ceil(a.total_count/a.page_size),a.loading=!1})).catch((function(t){console.log(t),a.$notify.error({title:"提示",message:"操作失败，可能不具备权限，请尝试注销重新登录或联系管理员"}),a.loading=!1}))},downloadLog:function(t){var a="/board/task/"+t+"?type=log",e=t+".log";this.$axios({url:a,method:"get",responseType:"blob",headers:{auth:window.localStorage.getItem("jeddak_token")}}).then((function(t){var a=new Blob([t.data]);if(window.navigator.msSaveOrOpenBlob)navigator.msSaveBlob(a,e);else{var o=document.createElement("a"),n=document.createEvent("HTMLEvents");n.initEvent("click",!1,!1),o.href=URL.createObjectURL(a),o.download=e,o.style.display="none",document.body.appendChild(o),o.click(),window.URL.revokeObjectURL(o.href)}}))},createTask:function(){this.$router.push("/task_new")},toDetail:function(t){this.$router.push("/task_detail?task_id="+t)},handleCurrentChange:function(t){this.getTaskData(t)},changeAlias:function(t){var a=this;this.$axios.patch("/board/task/"+t.task_id,{field:{alias:t.alias}},{headers:{auth:window.localStorage.getItem("jeddak_token")}}).then((function(t){a.$notify.success({title:"提示",message:"修改成功"})})).catch((function(t){console.log(t),a.$notify.error({title:"提示",message:"操作失败，可能不具备权限，请尝试注销重新登录或联系管理员"})}))}}}),l=s,i=(e("6cae"),e("2877")),r=Object(i["a"])(l,o,n,!1,null,"c0f60f06",null);a["default"]=r.exports},2323:function(t,a,e){},"6cae":function(t,a,e){"use strict";e("2323")}}]);
//# sourceMappingURL=chunk-2f6c3c48.0d3d5201.js.map